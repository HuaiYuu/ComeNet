@{
    ViewData["Title"] = "視訊";
}

<head>
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/ComeNet.styles.css" asp-append-version="true" />
</head>

<div>
    <p id="username" style="display:none"></p>
</div>


<body>
    <div>
        <section>
            <div class="container py-5">
                <div class="row d-flex justify-content-center">
                    <div class="col-md-8 col-lg-6 col-xl-4" style="width:75%;margin-top:10%">
                        <div class="card" id="chat1" style="border-radius: 15px;">
                            <div class="card-header d-flex justify-content-between align-items-center p-3 bg-info text-white border-bottom-0"
                                 style="border-top-left-radius: 15px; border-top-right-radius: 15px;">
                                <i class="fas fa-angle-left"></i>
                                <p class="mb-0 fw-bold">Live chat</p>
                                <i class="fas fa-times"></i>
                            </div>
                            <div class="card-body">
                                <div class="form-outline">
                                    <div id="chat"></div>
                                    <textarea class="form-control" id="message" rows="4"></textarea>
                                    <button id="sendbutton" onclick="sendMessage()" class="sendMessage">Send</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
</body>
<div class="container" id="user-list">
    <div class="row">
        <div class="col-md-8">
            <div class="people-nearby">
            </div>
        </div>
    </div>
</div>




<style>
    #chat1 .form-outline .form-control ~ .form-notch div {
        pointer-events: none;
        border: 1px solid;
        border-color: #eee;
        box-sizing: border-box;
        background: transparent;
    }

    #chat1 .form-outline .form-control ~ .form-notch .form-notch-leading {
        left: 0;
        top: 0;
        height: 100%;
        border-right: none;
        border-radius: .65rem 0 0 .65rem;
    }

    #chat1 .form-outline .form-control ~ .form-notch .form-notch-middle {
        flex: 0 0 auto;
        max-width: calc(100% - 1rem);
        height: 100%;
        border-right: none;
        border-left: none;
    }

    #chat1 .form-outline .form-control ~ .form-notch .form-notch-trailing {
        flex-grow: 1;
        height: 100%;
        border-left: none;
        border-radius: 0 .65rem .65rem 0;
    }

    #chat1 .form-outline .form-control:focus ~ .form-notch .form-notch-leading {
        border-top: 0.125rem solid #39c0ed;
        border-bottom: 0.125rem solid #39c0ed;
        border-left: 0.125rem solid #39c0ed;
    }

    #chat1 .form-outline .form-control:focus ~ .form-notch .form-notch-leading,
    #chat1 .form-outline .form-control.active ~ .form-notch .form-notch-leading {
        border-right: none;
        transition: all 0.2s linear;
    }

    #chat1 .form-outline .form-control:focus ~ .form-notch .form-notch-middle {
        border-bottom: 0.125rem solid;
        border-color: #39c0ed;
    }

    #chat1 .form-outline .form-control:focus ~ .form-notch .form-notch-middle,
    #chat1 .form-outline .form-control.active ~ .form-notch .form-notch-middle {
        border-top: none;
        border-right: none;
        border-left: none;
        transition: all 0.2s linear;
    }

    #chat1 .form-outline .form-control:focus ~ .form-notch .form-notch-trailing {
        border-top: 0.125rem solid #39c0ed;
        border-bottom: 0.125rem solid #39c0ed;
        border-right: 0.125rem solid #39c0ed;
    }

    #chat1 .form-outline .form-control:focus ~ .form-notch .form-notch-trailing,
    #chat1 .form-outline .form-control.active ~ .form-notch .form-notch-trailing {
        border-left: none;
        transition: all 0.2s linear;
    }

    #chat1 .form-outline .form-control:focus ~ .form-label {
        color: #39c0ed;
    }

    #chat1 .form-outline .form-control ~ .form-label {
        color: #bfbfbf;
    }

    .sendMessage {
        margin-left: 85%;
        margin-top: 2%;
    }


    body {
        margin-top: 20px;
        background: #FAFAFA;
    }
    /*==================================================
              Nearby People CSS
              ==================================================*/

    .people-nearby .google-maps {
        background: #f8f8f8;
        border-radius: 4px;
        border: 1px solid #f1f2f2;
        padding: 20px;
        margin-bottom: 20px;
    }

        .people-nearby .google-maps .map {
            height: 300px;
            width: 100%;
            border: none;
        }

    .people-nearby .nearby-user {
        padding: 20px 0;
        border-top: 1px solid #f1f2f2;
        border-bottom: 1px solid #f1f2f2;
        margin-bottom: 20px;
    }

    img.profile-photo-lg {
        height: 80px;
        width: 80px;
        border-radius: 50%;
    }


    .video {
        border: solid red;
    }
</style>


<script>
    
    function sendMessage() 
    {
        //const message = $("#message").val();
        //$("#chat").append(`<p>${message}</p>`);
        //$("#message").val("");


       


        //var h4Tags = document.querySelectorAll('a');
        //h4Tags.forEach(function (h4Tag) {
        //    h4Tag.addEventListener('click', function () {
        //        memberId = h4Tag.getAttribute('data-userid');
        //        console.log('Member ID:', memberId);
        //    });
        //});

        /////發送邀請api

        var username = document.getElementById('username');
        var content = username.textContent;
        console.log(content); 

        const message = $("#message").val();

        var myHeaders = new Headers();
        myHeaders.append("Content-Type", "application/json");

        var rawvideo = JSON.stringify({
            "name": content,
            "message": message,
            "userId": "19",
        });
        var requestvideo = {
            method: 'POST',
            headers: myHeaders,
            body: rawvideo,
            redirect: 'follow'
        };

        fetch("https://localhost:7136/api/users/ChatToSpecificUser", requestvideo)
            .then(response => response.json())
            .then(result => {
                if (result.userId != null) 
                {
                    console.log(result.userId);
                }
                else
                {
                    alert('請稍等');
                }

            })
            .catch(error => console.log('error', error));




        $("#message").val("");


    }

</script>

@*<script src="/js/signalr/dist/browser/signalr.js"></script>
<script src="/js/usernotification.js"></script>*@